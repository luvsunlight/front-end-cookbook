!> 当机器处于不安全环境时，切记不能通过http cookie存储和传输敏感信息

## 1. SQL注入

SQL注入的原理是前端在输入时进行了恶意的SQL拼装，那么最后生成的SQL就会有问题，但是现在基本稍微大型一点的系统都不会这么做，从提交登录信息到最后拿到授权，要经过层层的验证，基本上这个只会出现在比较低端小型的系统上

## 2. 会话劫持和xss

在web应用中，cookie常被用来标记用户或者授权会话。因此，如果有web应用的cookie被窃取，可能导致授权用户的会话遭到攻击。常用的窃取cookie的方法有利用社会工程学攻击和利用应用程序漏洞进行xss攻击

### 2.1 xss的定义

跨站脚本攻击XSS(Cross site scripting)，恶意攻击者往web页面中插入恶意js代码，当用户浏览该页面时，嵌入其中的js代码会被执行，从而达到恶意攻击用户的目的

比如说我们再一个博客网站上写博客，如果是正常的博客形式那完全没有问题，可如果我们撰写的是恶意的js脚本，例如获取到document.cookie然后传输到我自己的服务器上，那么我在博客网站上发布的这篇文章每被别人浏览一次，这段代码就被执行一次，访客的信息就会被泄露。

总结就是黑客通过发布文章/评论，将一段特定的js代码隐蔽地输入进去，然后别人再看这篇文章或者评论时，这段代码就执行了，这些恶意底阿妈拥有和原网页一样的权限

### 2.2 XSS的原理

* 攻击者对含有漏洞的服务器发起XSS攻击（注入js代码）
* 诱使受害者打开攻击的服务器url
* 受害者在web浏览器中打开url，恶意脚本执行

### 2.3 XSS的攻击方式

#### 反射型

发出请求时，xss代码出现在url中，作为输入提交到服务器端，服务器端解析后响应，xss随着响应内容一起返回给浏览器，最后浏览器解析执行xss代码

#### 存储型

存储型xss和反射型的xss差别就在于，存储型的xss提交的代码会存储在服务器端（数据库，内存，文件系统等），下次请求页面时不用再提交xss代码

### 2.4 XSS的防御措施

* 编码，对用户输入的数据进行html entity编码

![](https://img-blog.csdn.net/20170418160547231?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZ2FueWluZ3hpZTEyMzQ1Ng==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

* 过滤，移除用户上传的dom属性，如onerror，移除用户上传的style节点，script节点，iframe节点等
* 校正，避免直接对html entity编码，使用DOMparse转换，校正不配对的dom标签
* 对cookie进行较强的限制，比如对敏感的cookie增加http-only限制

### 2.5 xss的常见表现形式

img标签是自动触发而受到攻击的，p标签是引诱触发而遭到攻击的，而iframe是广告植入攻击的

## 3. 跨站请求伪造（CSRF）

Cross-site request forery跨站请求伪造，CSRF是借用了当前操作者的权限来偷偷完成该操作，而不是拿到用户的信息。

比如一个支付网站，付账的接口不需要密码，只要访问对应的url就可以完成付账，然后假如一个用户登陆了该网站，然后收到了一封邮件，打开该邮件，就通过img标签中的url完成了付款界面。它这里是利用了共享cookie的特性

预防CSRF就是加入各个层级的验证，比如输密码或指纹等

## 内容安全策略（CSP）

内容安全策略（CSP,Content Security Policy）是一个附加的安全层，用于帮助检测和缓解某些类型的攻击，包括跨站脚本

## Refer

* [Web安全之XSS攻防](https://blog.csdn.net/ganyingxie123456/article/details/70230486)

