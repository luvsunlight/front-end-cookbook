![](https://static001.geekbang.org/resource/image/43/9b/432360759ea2e98eb287a006cce87a9b.jpg)

## 1. 定义

哈希算法的定义和原理很简单，**将任意长度的二进制串映射为固定长度的二进制串**，这个映射的规则就是哈希算法，而通过原始数据映射后得到的二进制值串就是哈希值

一个优秀的哈希算法应该满足条件

* 从哈希值不能推导出原始数据
* 对输入数据非常敏感，哪怕原始数据只修改了一个bit，最后得到的哈希值也大不相同
* 散列冲突的概率很小，对于不同的原始数据，哈希值相同的概率非常小
* 哈希算法的执行概率尽量高效

## 2. 应用

### 2.1 安全加密

最常用语加密的哈希算法是MD5和SHA，对于加密的哈希算法来说，有两点格外重要，一个是很难根据哈希值反推出原始数据，第二个是散列冲突的概率要很小

### 2.2 唯一标识

先举一个例子，在海量的图库中，搜索一张图存不存在，不能单纯地用图片的元信息来判断，因为有可能存在名称相同但是图片内容不同或者完全相反的情况

我们可以给每一个图片取一个唯一标识，比如我们可以从图片的二进制码串开头取100个字节，中间和末尾各取100个，然后这300个字节再用md5来得到一个哈希，通过这样一个唯一标识来判断图片是否在图库中，可以减轻很多工作量

### 2.3 数据校验

p2p下载的原理是将大文件切割成很多文件块，等所有的文件块下载完了之后，再组装成一个完整的电影文件即可

我们知道网络传输是不安全的，下载的文件块可能是被宿主机器恶意修改过的，或者下载的过程出现了错误，我们应该如何来校验文件块的安全，完整性呢？

具体的bt协议很复杂，检验方法也很多，这里说一种方法

我们通过哈希算法对100个文件分别取哈希值，并且保存在种子文件里，下载完成后再依次比对哈希值

### 2.4 散列函数

散列函数对散列冲突的要求低很多，而且也对能否反向解密也不关心，更关心的是分布是否均匀，因此散列函数用的散列函数一般都比较简单，比较追求效率

### 2.5 负载均衡

负载均衡，也就是说，我们需要在同一个客户端上，在一次会话中的所有请求都路由到同一个服务器上

我们可以通过哈希算法，对客户端IP地址或者会话ID计算哈希值，将取得的哈希值和服务器列表的大小进行取模运算，最终得到的值就是应该被路由到的服务器编号

### 2.6 数据分片

#### 2.6.1 如何统计”搜索关键词“出现的频率

    我们先对数据进行分片，然后采用多台机器处理的方法，来提高处理速度。具体的思路是这样的，我们用n台机器并行处理，我们从搜索记录的日志记录中，依次读取每个搜索关键词，并且通过哈希函数计算哈希值，然后再跟n取模，最终得到的值，就是应该被分配到的机器编号
    这样，哈希值相同的搜索关键词就被分配到了同一个机器上，也就是说，同一个搜索关键词会被分配到同一个机器上，每个机器会分别计算关键词出现的次数，最后合并起来就是最终的结果

### 2.7 分布式存储